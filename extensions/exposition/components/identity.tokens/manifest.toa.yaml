namespace: identity
name: tokens

operations:
  encrypt:
    input:
      payload*: object
      lifetime: number
    output: string
  decrypt:
    input: string
    output:
      payload: object
      iat: string
      exp: string
      refresh: boolean
  authenticate:
    input: string
    output:
      identity: object
      stale: boolean

configuration:
  key0*: string
  key1: string
  lifetime: 2592000 # seconds (30 days)
  refresh: 600 # seconds
