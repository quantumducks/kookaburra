namespace: identity
name: tokens

entity:
  schema:
    revokedAt: number
  initialized: true

operations:
  encrypt:
    input:
      identity*: &payload
        id: string
        ...: true
      lifetime: number # ms
    output: string
  decrypt:
    input: string
    output:
      identity: *payload
      iat: string
      exp: string
      refresh: boolean
  authenticate:
    input: string
    output:
      identity: *payload
      refresh: boolean
  revoke:
    concurrency: retry

configuration:
  key0*: string
  key1: string
  lifetime: 2592000000 # ms (30 days)
  refresh: 900000      # ms (15 minutes)
